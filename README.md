# single_neuron_pattern_learning_paper
All scripts that's associated with the pattern learning paper

## Project Organization

### Data Processing Workflow
1. **Raw ABF Files → HDF5 Conversion**: 
   - `conversion_scripts/convert_abf_to_hdf5_cell_by_cell_with_stats_training_control_included.py`
   - `conversion_scripts/compile_firing_data_protocols_to_pickle_and_extract_features.py`

2. **HDF5 → Pickle Aggregation**: 
   - `conversion_scripts/compile_cell_dfs_to_pickle.py`

3. **Feature Extraction & Analysis**: 
   - `analysis_scripts/extract_features_and_save_pickle.py`

4. **Figure Generation**: 
   - `plotting_scripts/main_figures/` - Main manuscript figures (Figures 1-8)
   - `plotting_scripts/supplementary_figures/` - Supplementary figures (Supp 1-2)

### Script Organization

#### Plotting Scripts Structure:
- **`plotting_scripts/main_figures/`** - Contains scripts for main manuscript figures
- **`plotting_scripts/supplementary_figures/`** - Contains scripts for supplementary figures  
- **`plotting_scripts/not_used/`** - Deprecated or utility scripts not directly used for figures

#### Analysis Scripts:
- **`analysis_scripts/extract_features_and_save_pickle.py`** - Main feature extraction pipeline
- **`analysis_scripts/calculate_scale_bar_40x_automated_image_save.py`** - Functional scale bar script
- **`analysis_scripts/not_used/`** - Older scale bar scripts

## Usage Examples

### Analysis Script Path
```bash
python analysis_scripts/extract_features_and_save_pickle.py -f /path/to/data/all_data_with_training_df.pickle -s /path/to/cell_stats.h5 -o ./
```

### Main Figures (Standard Analysis)

**Figure 1**
```bash
python plotting_scripts/main_figures/figure_generation_script_1.py -f /path/to/baseline_traces_all_cells.pickle -i /path/to/with\ fluorescence\ and\ pipette.bmp -p /path/to/Screenshot\ 2023-06-28\ at\ 22.21.46.jpeg -t /path/to/pd_all_cells_all_trials.pickle
```

**Figure 2**
```bash
python plotting_scripts/main_figures/figure_generation_script_2_fnorm.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -r /path/to/all_cells_inR.pickle -i /path/to/figure_2_1.jpg -p /path/to/figure_2_2.jpg -m /path/to/figure_2_3.png
```

**Figure 3**
```bash
python plotting_scripts/main_figures/figure_generation_script_3.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_3_1.png -c /path/to/cell_stats.h5 -a /path/to/pd_all_cells_all_trials.pickle -t /path/to/pd_training_data_all_cells_all_trials.pickle -q /path/to/all_cell_all_trial_firing_properties.pickle -r /path/to/all_cells_inR.pickle -p /path/to/figure_2_2.jpg
```

**Figure 4**
```bash
python plotting_scripts/main_figures/figure_generation_script_4.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_3_1.jpg -c /path/to/cell_stats.h5 -t /path/to/pd_all_cells_all_trials.pickle
```

**Figure 5**
```bash
python plotting_scripts/main_figures/figure_generation_script_5.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_5_1.png -c /path/to/cell_stats.h5 -t /path/to/pd_all_cells_all_trials.pickle
```

**Figure 6**
```bash
python plotting_scripts/main_figures/figure_generation_script_6_v2.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_3_1.png -c /path/to/cell_stats.h5
```

**Figure 7**
```bash
python plotting_scripts/main_figures/figure_generation_script_7_learner_non_learner_comparison_v3.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_6_1.png -c /path/to/cell_stats.h5 -t /path/to/pd_all_cells_all_trials.pickle
```

**Figure 8**
```bash
python plotting_scripts/main_figures/figure_generation_script_8.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle
```

### Supplementary Figures

**Supplementary 1**
```bash
python plotting_scripts/supplementary_figures/figure_generation_script_supp_1.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_3_1.jpg -c /path/to/cell_stats.h5 -t /path/to/pd_all_cells_all_trials.pickle
```

**Supplementary 2**
```bash
python plotting_scripts/supplementary_figures/figure_generation_script_supp_2.py -f /path/to/pd_all_cells_mean.pickle -s /path/to/all_cells_classified_dict.pickle -i /path/to/Figure_3_1.jpg -c /path/to/cell_stats.h5 -t /path/to/pd_all_cells_all_trials.pickle
```

### Field Normalized Analysis
For field normalized versions, use the corresponding `_fnorm.py` scripts and substitute the classification pickle with `all_cells_fnorm_classifeied_dict.pickle`

## Data Dependencies
All scripts require processed pickle files generated by the analysis pipeline:
- `pd_all_cells_mean.pickle` - Trial-averaged EPSP features
- `all_cells_classified_dict.pickle` - Cell learner/non-learner classifications
- `pd_all_cells_all_trials.pickle` - Single trial data
- `all_cells_inR.pickle` - Input resistance and intrinsic properties
- `cell_stats.h5` - Cell health statistics

"analysis script path"
:! python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/all_data_with_training_df.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -o ./


"plotting scripts parsers from bash/zsh on vim"



"figure 1"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/baseline_traces_all_cells.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/with\ fluorescence\ and\ pipette.bmp -p /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/Screenshot\ 2023-06-28\ at\ 22.21.46.jpeg -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"figure 2"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -r /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_inR.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_1.jpg -p /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_2.jpg -m /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_3.png


"figure 3"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -a /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_training_data_all_cells_all_trials.pickle -q /Users/anzalks/Documents/Expt_data/CA1_recordings/x_spread_recording_02Hz_30mins/cells_cumulated/cells_min_30mins_long/pickle_format_files_firing_rate_data/all_cell_all_trial_firing_properties.pickle -r /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_inR.pickle -p /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_2.jpg

"figure 4"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.jpg -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle


"figure 5"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_5_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"figure 6"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5

"Figure 7"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_6_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"suplimentary 1"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.jpg -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"sumplimentary 2"

!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_classified_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.jpg -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle



Plot with feild normalised data:

"figure 1"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/baseline_traces_all_cells.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/with\ fluorescence\ and\ pipette.bmp -p /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/Screenshot\ 2023-06-28\ at\ 22.21.46.png -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"figure 2"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -r /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_inR.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_1.jpg -p /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_2.jpg -m /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_3.png


"figure 3"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -a /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_training_data_all_cells_all_trials.pickle -q /Users/anzalks/Documents/Expt_data/CA1_recordings/x_spread_recording_02Hz_30mins/cells_cumulated/cells_min_30mins_long/pickle_format_files_firing_rate_data/all_cell_all_trial_firing_properties.pickle -r /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_inR.pickle -p /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/figure_2_2.jpg

"figure 4"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.jpg -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle


"figure 5"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_5_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"figure 6"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5

"Figure 7"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_6_1.png -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"suplimentary 1"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.jpg -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle

"sumplimentary 2"
!python % -f /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_mean.pickle -s /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/all_cells_fnorm_classifeied_dict.pickle -i /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/illustations/Figure_3_1.jpg -c /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/data/pickle_files/cell_stats.h5 -t /Users/anzalks/Documents/pattern_learning_paper/plotting_scripts/python_scripts_paper_ready/analysis_scripts/pickle_files_from_analysis/pd_all_cells_all_trials.pickle


